<h4>《史部·新唐书·卷二十八下  志第十八下》<b class="x">作者：欧阳修、宋祁等</b></h4>
◎历四下○六曰步交会术终数八亿二千七百二十五万一千三百二十二。交终日二十七，余六百四十五，秒千三百二十二。中日十三，余千八百四十二，秒五千六百六十一。朔差日二，余九百六十七，秒八千六百七十八。望差日一，余四百八十三，秒九千三百三十九。望数日十四，余二千三百二十六，秒五千。交限日十二，余千三百五十八，秒六千三百二十二。交率三百四十三。交数四千三百六十九。交秒法一万。以交数去朔积分；不尽，以秒法乘之，盈交数又去之；余如秒法而一，为入交分。满通法为日，命日算外，得天正经朔时加入交泛日及余。因加朔差，得次朔。以望数加朔，得望。若以经朔望小余减之，各得夜半所入。累加一日，得次日。加之满交终，去之。各以其日入气朓朒定数，朓减、朒加入交泛，为入交常日及余。又以交率乘其日入转朓朒定数，如交数而一，而朓减、朒加入交常，为入交定日及余。各如中日已下者，为月入阳历；已上者，去之，余为月入阴历。○阴阳历以其爻加减率与后爻加减率相减，为前差。又以后爻率与次后爻率相减，为后差。二差相减，为中差。置所在爻并后爻加减率，半中差以加而半之，十五而一，为爻末率，因为后爻初率。每以本爻初、末率相减，为爻差。十五而一，为度差。半之，以加减初率，（少象减之，老象加之。）为定初率。每以度差累加减之，少象以差减，老象以差加。各得每岁加减定分。乃循积其分，满百二十为度，各为月去黄道数及分。（其四象初爻无初率，上爻无末率，皆倍本爻加减率，十五而一。所得各以初、末率减之，皆互得其率。）各置夜半入转，以夜半入交定日及余减之，（不足减，加转终。）余为定交初日夜半入转。乃以定交初日与其日夜半入余，各乘其日转定分，如通法而一，为分。满转法，为度。各以加其日转积度分，乃相减，所余为其日夜半月行入阴阳度数。（转求次日，以转定分加之。）以一象之度九十除之，（若以少象除之，则兼除差度一、度分百六、大分十三、小分十四。讫，然后以次象除之。）所得以少阳、老阳、少阴、老阴为次，起少阳算外，得所入象度数及分。（先以三十乘阴阳度分，十九而一，为度分。不尽，以十五乘、十九除，为大分。不尽者，又乘、又除，为小分。然后以象度及分除之。）乃以一爻之度十五除之，所得入爻度数及分。（其月行入少象初爻之内及老象上爻之中，皆沾黄道。当朔望，则有亏蚀。）凡入交定如望差已下，交限已上，为入蚀限；望入蚀限，则月蚀。朔入蚀限，月在阴历，则日蚀。如望差已下，为交后。交限已上，以减交中，余为交前。置交前、后定日及余，通之，为去交前、后定分。十一乘之，二千六百四十三除，为去交度数。不尽，以通法乘之，复除为余。（大抵去交十三度已上，虽入蚀限，为涉交数微，光景相接，或不见蚀。）望去交分七百七十九已下者，皆既。已上者，以定交分减望差，余以百八十三约之，命以十五为限，得月蚀之大分。月在阴历，初起东南，甚于正南，复于西南；月在阳历，初起东北，甚于正北，复于西北。其蚀十二分已上者，起于正东，复于正西。（此据午正而论之。余各随方面所在，准此取正。）凡月蚀之大分五已下，因增三。十已下，因增四。十已上，因增五。其去交定分五百二十已下，又增半。二百六十已下，又增半。各为泛用刻率。以所入气并后气增损差，倍六爻乘之，综两气辰数除之，为气末率。又列二气增损差，皆倍六爻乘之，各如辰数而一；少减多，余为气差。加减末率（冬至后以差减，夏至后以差加。）为初率。倍气差，综两气辰数除，为日差。半之，加减初、末，为定率。以差累加、减气初定率，（冬至后以差加，夏至后以差减。）为每日增损差。乃循积之，随所入气日增损气下差积，各其日定数。（其二至之前一气，皆后无同差，不可相并，各因前末为初率。以气差冬至前减、夏至前加，为末率。）阴历蚀差千二百七十五，蚀限三千五百二十四，或限三千六百五十九。阳历蚀限百三十五，或限九百七十四。以蚀朔所入气日下差积，阴历减之，阳历加之，各为蚀定差及定限。朔在阴历，去交定分满蚀定差已上者，为阴历蚀。不满者，虽在阴历，皆类同阳历蚀。其去交定分满定限已下者，的蚀。或限已下者，或蚀。阴历蚀者，置去交定分，以蚀定差减之，余百四已下者，皆蚀既。已上者，以百四减之。余以百四十三约之。其入或限者，以百五十二约之。半已下，为半弱。半已上，为半强。以减十五，余为日蚀之大分。其同阳历蚀者，其去交定分少于蚀定差六十已下者，皆蚀既。已上者，以阳历蚀定限加去交分，以九十约之。其阳历蚀者，置去交定分，亦以九十约之。入或限者，以百四十三约之。皆半已下，为半弱。半已上，为半强。命之，以十五为限，得日蚀之大分。月在阴历，初起西北，甚于正北，复于东北。月在阳历，初起西南，甚于正南，复于东南。其蚀十二分已上，皆起于正西，复于正东。凡日蚀之大分，皆因增二。其阴历去交定分多于蚀定差七十已上者，又增；三十五已下者，又增半。其同阳历去交定分少于蚀定差二十已下者，又增半；四已下者，又增少。各为泛用刻率。置去交定分，以交率乘之，二十乘交数除之；其月道与黄道同名者，以加朔望定小余：异名者，以减朔、望定小余：为蚀定余。如求发敛加时术入之，得蚀甚辰刻。各置泛用刻率，副之。以乘其日入转损益率，如通法而一。所得应朒者，依其损益；应朓者，损加、益减其副：为定用刻数。半之，以减蚀甚辰刻，为亏初；以加蚀甚辰刻，为复末。（其月蚀，置定用刻数，以其日每更差刻除，为更数。不尽，以每筹差刻除，为筹数。综之为定用更筹。乃累计日入后至蚀甚辰刻，置之，以昏刻加日入辰刻减之，余以更筹差刻除之。所得命以初更筹算外，得蚀甚更筹。半定用更筹减之，为亏初；加之，为复末。按天竺俱摩罗所传断日蚀法，日躔郁车宫者，的蚀。其余据日所在宫，火星在前三及后五之宫，并伏在日下，则不蚀。若五星皆见，又水在阴历及三星已上同聚一宿，则亦不蚀。凡星与日别宫或别宿则易断，若同宿则难。天竺所云十二宫，即中国之十二次。郁车宫者，降娄之次也。）九服之地，蚀差不同。先测其地二至及定春秋分中晷长短，与阳城每日中晷常数较取同者，各因其日蚀差为其地二至及定春秋分蚀差。以夏至差减春分差，以春分差减冬至，各为率。并二率，半之，六而一，为夏率。二率相减，六而一，为总差。置总差，六而一，为气差。半气差，以加夏率，又以总差减之，为冬率。（冬率即冬至率。）每以气差加之，各为每气定率。乃循积其率，以减冬至蚀差，各得每气初日蚀差。（求每日，如阳城法求之。若戴日之南，当计所在地，皆反用之。）○七曰步五星术△岁星终率百二十一万二千五百七十九，秒六。终日三百九十八，余二千六百五十九，秒六。变差三十四，秒十四。象算九十一，余二百三十八，秒五十七，微分十二。爻算十五，余百六十六，秒四十二，微分八十二。△荧惹终率二百三十七万一千三，秒八十六。终日七百七十九，余二千八百四十三，秒八十六。变差三十二，秒二。象算九十一，余二百三十八，秒四十三，微分八十四。爻算十五，余百六十六，秒四十，微分六十二。△镇星终率百一十四万九千三百九十九，秒九十八。终日三百七十八，余二百七十九，秒九十八。变差二十二，秒九十二。象算九十一，余二百三十七，秒八十七。爻算十五，余百六十六，秒三十一，微分十六。△太白终率百七十七万五千三十，秒十二。终日五百八十三，余二千七百一十一，秒十二。中合日二百九十一，余二千八百七十五，秒六。变差三十，秒五十三。象算九十一，余二百三十八，秒三十四，微分五十四。爻算十五，余百六十六，秒三十九，微分九。△辰星终率三十五万二千二百七十九，秒七十二。终日百一十五，余二千六百七十九，秒七十二。中合日五十七，余二千八百五十九，秒八十六。变差百三十六，秒七十八。象算九十一，余二百四十四，秒九十八，微分六十。爻算十五，余百六十七，秒四十九，微分七十四。辰法七百六十。秒法一百。微分法九十六。置中积分，以冬至小余减之，各以其星终率去之，不尽者，返以减终率；余满通法为日，得冬至夜半后平合日算。各以其星变差乘积算，满干实去之；余满通法，为日。以减平合日算，得入历算数。皆四约其余，同于辰法。及以一象之算除之，以少阳、老阳、少阴、老阴为次，起少阳算外。余以一爻之算除之；所得命起其象初爻算外，得外入爻算数。○五星爻象历以所入爻与后爻损益率相减，为前差；又以后爻与次后爻损益率相减，为后差；二差相减，为中差。置所入爻并后爻损益率，半中差以加之，九之，二百七十四而一，为爻末率，因为后爻初率。（皆因前爻末率，以为后爻初率。）初、末之率相减，为爻差。倍爻差，九之，二百七十四而一，为算差。半之，加减初、末，各为定率。以算差累加、减爻初定率，（少象以差减，老象以差加。）为每算损益率。循累其率，随所入爻损益其下进退积，各得其算定数。（其四象初爻无初率，上爻无末率，皆置本爻损益率四而九之，二百七十四得一，各以初、末率减之，皆互得其率。）各置其星平合所入爻之算差，半之，以减其入算损益率。损者，以所入余乘差，辰法除，并差而半之；益者，半入余，乘差，亦辰法除：皆中所减之率。乃以入余乘之，辰法而一。所得以损益其算下进退，各为平合所入定数。置进退定数，（金星则倍置之。）各以合下乘数乘之，除数除之。所得满辰法为日，以进加、退减平合日算，（先以四约平合余，然后加减。）为常合日算。置常合日先后定数，四而一，以先减、后加常合日算，得定合日算。又四约盈缩分，以定合余乘之，满辰法而一。所得以盈加、缩减其定余，加其日夜半日度，为定合加时星度。又置定合日算，以冬至大小余加之，天正经朔大小余减之。（其至朔小余，皆先以四约之。若大余不足减，又以爻数加之，乃减之。）余满四象之策除，为月数。不尽者，为入朔日算。命月起天正、日起经朔算外，得定合月、日。（视定朔与经朔有进退者，亦进减、退加一日为定。）置常合及定合应加减定数，同名相从，异名相消；乃以加减其平合入爻算，满若不足，进退爻算，得定合所入。乃以合后诸变历度累加之，去命如前，得次变初日所入。如平合求进退定数，乃以乘数乘之，除数除之，各为进退变率。五星变行日中率、度中率、差行损益率、历度（乘数、除数）○岁星合后伏：十七日三百三十二分，行三度三百三十二分。先迟，二日益疾九分。历，一度三百五十七分。（乘数三百五十，除数二百八十一。）前顺：百一十二日，行十八度六百五十六分。先疾，五日益迟六分。历，九度三百三十七分。（乘数三百五十，除数二百八十一。）前留：二十七日。历，二度二百二十分。（乘数二百六十七，除数二百二十一。）前退：四十三日，退五度三百六十九分。先迟，六日益疾十一分。历，三度四百七十五分。（乘数四百七十，除数四百三。）后退：四十三日，退五度三百六十九分。先迟，六日益迟十一分。历，三度四百七十五分。（乘数五百一十，除数四百六十七。）后留：二十七日。历，三度二百一十分。（乘数二百七十，除数二百二十二。）后顺：百一十二日，行十八度六十五分。先迟，五日益疾六分。历，九度三百三十七分。（乘数二百六十七，除数二百二十七。）合前伏：十七日三百三十二分，行三度三百三十二分。先疾，二日益迟九分。历，一度三百五十八分。（乘数三百五十，除数二百八十一。）○荧惑合后伏：七十一日七百三十五分，行五十四度七百三十五分。先疾，五日益迟七分。历，三十八度二百一分。（乘数百二十七，除数三十。）前疾：二百一十四日，行百三十六度。先疾，九日益迟四分。历，百一十三度五百九十六分。（乘数百二十七，除数三十。）前迟：六十日，行二十五度。先疾，日益迟四分。历，三十一度六百八十五分。（乘数二百三，除数五十四。）前留：十三日，历，六度六百九十三分。（乘数二百三，除数五十四。）前退：三十一日，退八度四百七十三分。先迟，六日益疾五分。历，十六度三百六十七分。（乘数二百三，除数四十八。）后退：三十一日，退八度四百七十三分。先疾，六日益迟五分。历，十六度三百六十七分。（乘数二百三，除数四十八。）后留：十三日。历，六度六百九十三分。（乘数二百三，除数四十八。）后迟：六十日，行二十五度。先迟，日益疾四分。历，三十一度六百八十五分。（乘数二百三，除数五十四。）后疾：二百一十四日，行百三十六度。先迟，九日益疾四分。历，百一十三度五百九十六分。（乘数二百三，除数五十四。）合前伏：七十一日七百三十六分，行五十四度七百三十六分。先迟，五日益疾七分。历，三十八度二百一分。（乘数百二十七，除数三十。）○镇星合后伏：十八日四百一十五分，行一度四百一十五分。先迟，二日益疾九分。历，四百八十分。（乘数十二，除数十一。）前顺：八十三日，行七度二百四十一分。先疾，六日益迟五分。历，二度六百二十三分。（乘数十二，除数十一。）前留：三十七日三百八十分。历，一度二百八分。（乘数十，除数九。）前退：五十日，退二度三百三十四分。先迟，七日益疾一分。历，一度五百三十一分。（乘数二十，除数十七。）后退：五十日，退二度三百三十四分，先疾，七日益迟一分。历，一度五百三十一分。（乘数五，除数四。）后留：三十七日三百八十分。历，一度二百八分。（乘数二十，除数一十七。）后顺：八十三日，行七度二百四十一分。先迟，六日益疾五分。历，二度六百二十三分。（乘数十，除数九。）合前伏：十八日四百一十五分，行一度四百一十五分。先疾，二日益迟九分。历，四百八十分。（乘数十二，除数十一。）○太白晨合后伏：四十一日七百一十九分，行五十二度七百一十九分。先迟，三日益疾十六分。历，四十一度七百一十九分。（乘数七百九十七，除数二百九。）夕疾行：百七十一日，行二百六度。先疾，五日益迟九分。历，百七十一度（乘数七百九十七，除数二百九。）夕平行：十二日，行十二度。历，十二度。（乘数五百一十五，除数百五十六。）夕迟行：四十二日，行三十一度，先疾，日益迟十分。历，四十二度。（乘数五百一十五，除数百三十七。）夕留：八日。历，八度。（乘数五百一十五，除数九十二。）夕退：十日，退五度。先迟，日益疾九分。历，十度。（乘数五百一十五，除数八十六。）夕合前伏：六日，退五度。先疾，日益迟十五分。历，六度。（乘数五百一十五，除数八十四。）夕合后伏：六日，退五度。先迟，日益疾十五分。历，六度。（乘数五百一十五，除数八十三。）晨退：十日，退五度。先疾，日益迟九分。历，十度。（乘数五百一十五，除数八十四。）晨留：八日，历八度。（乘数五百一十五，除数八十六。）晨迟行：四十二日，行三十一度。先迟，日益疾十分。历，四十二度。（乘数五百一十五，除数九十二。）晨平行：十二日，行十二度。历，十二度。（乘数五百一十五，除数百三十七。）晨疾行：百七十一日，行二百六度。先迟，五日益疾九分。历，百七十一度。（乘数五百一十五，除数百五十六。）晨合前伏：四十一日七百一十九分，行五十二度七百一十九分。先疾，三日益迟十六分。历，四十一度七百一十九分。（乘数七百九十七，除数二百九。）○辰星晨合后伏：十六日七百一十五分，行三十三度七百一十五分。先迟，日益疾二十二分。历，十六度七百一十五分。（乘数二百八十六，除数二百八十七。）夕疾行：十二日，行十七度。先疾，日益迟五十分。历，十二度。（乘数二百八十六，除数二百八十七。）夕平行：九日，行九度。历，九度。（乘数四百九十五，除数百九十四。）夕迟行：六日，行四度。先疾，日益迟七十六分。历，六度。（乘数四百九十六，除数百九十五。）夕留：三日。历，三度。（乘数四百九十七，除数百九十六。）夕合前伏：十一日，退六度。先迟，日益疾三十一分。历，十一度。（乘数四百九十八，除数百九十七。）夕合后伏：十一日，退六度。先疾，日益迟三十一分。历，十一度。（乘数五百，除数百九十八。）晨留：三日。历，三度。（乘数四百九十八，除数百九十八。）晨迟行：六日，行四度。先迟，日益疾七十六分。历，六度。（乘数四百九十七，除数百九十六。）晨平行：九日，行九度。历，九度。（乘数四百九十六，除数百九十五。）晨疾行，十二日，行十七度。先迟，日益疾五十分。历，十二度。（乘数四百九十二，除数百九十四。）晨合前伏：十六日七百一十五分，行三十三度七百一十五分。先疾，日益迟二十二分。历，十六度七百一十五分。（乘数二百八十六，除数二百八十七。）各置其本进退变率与后变率。同名者，相消为差。在进前少，在退前多，各以差为加；在进前多，在退前少，各以差为减。异名者，相从为并。前退后进，各以并为加；前进后退，各以并为减。逆行度率则反之。皆以差及并，加、减日度中率，各为日度变率。（其水星疾行，直以差、并加、减度中率，为变率。其日直因中率为变率，勿加、减也。）以定合日与前疾初日、后疾初日与合前伏初日先后定数，各以同名者相消为差，异名者相从为并。皆四而一。所得满辰法，各为日度。乃以前日度盈加、缩减其合后伏度之变率及合前伏、前疾日之变率，亦以后日度盈减、缩加其后疾日之变率及合前伏、前疾度之变率。（金水夕合，反其加减。留退亦然。）其二留日之变率，若差于中率者，即以所差之数为度，各加、减本迟度之变率。（谓以所多于中率之数加之，少于中率之数减之。已下加、减准此。）退行度之变率，若差于中率者，即倍所差之数，各加、减本疾度之变率。（其土、木二星，既无迟、疾，即加、减前、后顺行度之变率。）其水星疾行度之变率，若差于中率者，即以所差之数为日，各加、减留日变率。（其留日变率若少不足减者，即侵减迟日变率；若多于中率者，亦以所多之数为日，以加留日变率。）各加、减变率讫，皆为日度定率。其日定率有分者，前后辈之。（辈，配也，以少分配多分，满全为日。有余转配其诸变率。不加减者，皆依变率为定率。）置其星定合余，以减辰法；余以其星初日行分乘之，辰法而一，以加定合加时度，得定合后夜半星度及余。（自此各依其星计日行度，所至皆从夜半为始。）各以一日所行度分顺加、退减之。其行有小分者，各满其法从行分。伏不注度，留者因前，退则依减。顺行出虚，去六虚之差。退行入虚，先加此差。（六虚之差，亦四而一，乃用加减。）讫，皆以转法约行分，为度分，得每日所至。（日度定率，或加或减，益疾益迟，每日渐差，不可预定。今且略据日度中率，商量置之。其定率既有盈缩，即差数合随而增损，当先检括诸变定率与中率相较近者因用其差，求其初、末之日行分为主。自余诸变，因此消息，加、减其差，各求初、末行分。循环比较，使际会参合，衰杀相循。其金、水皆以平行为主，前后诸变，准此求之。其合前伏，虽有日度定率，因加至合而与后算不叶者，皆从后算为定。其初见伏之度，去日不等，各以日度与星辰相较。木去日十四度，金十一度，火、土、水各十七度皆见。各减一度，皆伏。其木、火、土三星，前顺之初，后顺之末，及金、水疾行、留、退初、末，皆是见、伏之初日，注历消息定之。金、水及日、月度，皆不注分。）置日定率减一，以所差分乘之，为实。以所差日乘定日率，为法。实如法而一，为行分，得每日差。以辰法通度定率，从其分，如日定率而一，为平行度分。减日定率一，以所差分乘之，二而一，为差率。以加、减平行分，（益疾者，以差率减平行为初日，加平行为末日；益迟者，以差率加平行为初日，减平行为末日。）得初、末日所行度及分。（其差不全而与日相合者，先置日定率减一，以所差分乘之，为实。倍所差日，为法。实如法而一，为行分。不尽者，因为小分。然后为差率。）置初日行分，益迟者，以每日差累减之；益疾者，以每日差累加之：得次日所行度分。（其每日差及初日行，皆有小分。母既不同，当令同之，乃用加、减。）其先定日数而求度者，减所求日一，以每日差乘之，二而一。所得以加、减初日行分，（益迟减之，益疾加之。）以所求日乘之，如辰法而一，为度。不尽者，为行分，得从初日至所求日积度及分。若先定度数而返求日者，以辰法乘所求行度。有分者，从之。八之，如每日差而一，为积。倍初日行分，以每日差加、减之，（益迟者加之，益疾者减之。）如每日差而一，为率。令自乘，以积加、减之。（益迟者以积减之，益疾者以积加之。）开方除之，所得以率加、减之。（益迟者以率加之，益疾者以率减之。）乃半之，得所求日数。（开方除者，置所开之数为实。借一算于实之下，名曰下法。步之，超一位。置商于上方，副商于下法之上，名曰方法。命上商以除实。毕，倍方法一折，下法再折。乃置后商于下法之上，名曰隅法。副隅并方。命后商以除实。毕，隅从方法折下，就除如前开之。）五星前变，入阳爻，为黄道北；入阴爻，为黄道南。后变，入阳爻，为黄道南；入阴爻，为黄道北。（其金、水二星，以夕为前变，晨为后变。各计其变行，起初日入爻之算，尽老象上爻未算之数。不满变行度常率者，因置其数以变行日定率乘之，如变行度常率而一，为日。其入变日数与此日数已下者，星在道南北依本所入阴阳爻为定。过此日数之外者，南北返之。）《九执历》者，出于西域。开元六年，诏太史监瞿坛悉达译之。断取近距，以开元二年二月朔为历首。度法六十。月有二十九日，余七百三分日之三百七十三。历首有朔虚分百二十六。周天三百六十度，无余分。日去没分九百分度之十三。二月为时，六时为岁。三十度为相，十二相而周天。望前曰白博义；望后曰黑博义。其算皆以字书，不用筹策。其术繁碎，或幸而中，不可以为法。名数诡异，初莫之辩也。陈玄景等持以惑当时，谓一行写其术未尽，妄矣。<hr>
